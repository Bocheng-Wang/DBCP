{% extends 'base.html' %}
{% load i18n %}
{% load static %}
{% block title %}{% translate 'KBCA Analysis in DBCP-Online' %}{% endblock %}
{% block css %}
    <link rel="stylesheet" href="{% static 'css/DBCP.Online/dropzone.css' %}">
    <link rel="stylesheet" href="{% static 'Bootstrap-table/bootstrap-table.min.css' %}">
    <link rel="stylesheet" href="{% static 'bootstrap-switch/css/bootstrap3/bootstrap-switch.css' %}">
    <link rel="stylesheet" href="{% static 'swiper-6.4.15/swiper-master/package/swiper-bundle.min.css' %}">
    <link rel="stylesheet" href="{% static 'css/DBCP.Online/Preprocessing.css' %}">
{% endblock %}
{% block script %}
    <script src="{% static 'Bootstrap-table/bootstrap-table.min.js' %}"></script>
    <script src="{% static 'Bootstrap-table/bootstrap-table-locale-all.min.js' %}"></script>
    <script src="{% static 'bootstrap-switch/js/bootstrap-switch.js' %}"></script>
    <script src="{% static 'Bootstrap-table/extensions/filter-control/bootstrap-table-filter-control.min.js' %}"></script>
    <script src="{% static 'swiper-6.4.15/swiper-master/package/swiper-bundle.min.js' %}"></script>
    <script src="{% static 'js/DBCP.Online/KBCA.js' %}"></script>
{% endblock %}
{% block content %}
    {% if request.session.is_login %}
        <div class="container-fluid">
            <div class="row">
                <div class="col-md-12">
                    <div class="page-header">
                        <h1>
                            {% translate 'KBCA Analysis' %}
                            <small>{% translate 'KBCA Analysis' %}</small>
                        </h1>
                    </div>
                </div>
            </div>
            <div id="myDataRow" class="row">
                <div class="col-md-12">
                    <div class="panel panel-primary">
                        <div class="panel-heading text-center">

                            <label class="label label-primary">共计 KBCA 任务： {{ totalRecords }}</label>
                            <label class="label label-info">已完成： {{ completeRecords }}</label>
                            <label class="label label-success">正在运行： {{ runningRecords }}</label>
                            <label class="label label-warning">等待调度： {{ waitingRecords }}</label>
                            <label class="label label-danger">失败： {{ FailedRecords }}</label>
                            |
                            <label class="label label-primary">运行服务器： {{ runningRecords }}</label>
                            <label class="label label-success">空闲服务器： {{ idleServer }}</label>
                            <label class="label label-danger">宕机服务器： {{ deadServer }}</label>
                        </div>


                        {#                        <div class="panel-heading text-center">#}
                        {#                            <label class="label label-default">李蕾： {{ LiLei }}</label>#}
                        {#                            <label class="label label-default">Aaron08131： {{ Aaron08131 }}</label>#}
                        {#                            <label class="label label-default">王意培： {{ WangYipei }}</label>#}
                        {#                            <label class="label label-default">测试账号（Test）： {{ Test }}</label>#}
                        {#                        </div>#}
                        <div class="panel-body">
                            {#                            <div class="row">#}
                            {#                                <div class="col-md-12">#}
                            {#                                    <input type="text" id="SearchAllInput" onkeyup="myFunction()"#}
                            {#                                           placeholder={% translate 'Search...' %}>#}
                            {#                                </div>#}
                            {#                            </div>#}
                            <table data-url="/KalmanFilter/CheckTasks/ALL"
{#                                   data-pagination="true"#}
                                   data-locale="zh-CN"
                                   data-single-select="true"
                                   data-detail-view="true"
                                   data-detail-formatter="myUpload_detailFormatter"
                                    {#                                   data-click-to-select="true"#}
                                   data-toggle="table"
                                   data-page-size="15"
                                   data-sort-name="Task_EndTime"
                                   data-sort-order="desc"
                                   data-sortable="true"
                                   data-pagination="true"
                                   data-side-pagination="server"
                                   data-query-params-type=" "
                                   data-query-params="queryParams"
                                    {#                                   data-filter-control="true"#}
{#                                   data-page-list=[5,10,20,50,All]#}
                                   data-row-style="dataRowStyle"
                                   id="PreprocessingTable" class="table-striped  table-sm">
                                <thead>
                                <tr>
                                    <th data-align="center" data-field="ModalID">
                                        ModalID
                                    </th>
                                    <th data-align="center" data-field="database">
                                        Source
                                    </th>
                                    <th data-align="center" data-sortable="true" data-filter-control="select"
                                        data-field="subjectID">
                                        Subject
                                    </th>
                                    <th data-align="center" data-visible="false" data-field="group">
                                        Group
                                    </th>

                                    <th data-align="center" data-field="visit">
                                        Visit
                                    </th>
                                    <th data-align="center" data-sortable="true" data-filter-control="select"
                                        data-field="diagnosis">
                                        Group
                                    </th>
                                    <th data-align="center" data-sortable="true" data-filter-control="select"
                                        data-field="uploader">
                                        Uploader
                                    </th>

                                    <th data-field="operate"
                                        data-align="center"
                                        data-events=""
                                        data-width="150"
                                        data-formatter="progress_StaticFormatter">
                                        Calculation Progress
                                    </th>


                                    <th data-field="Task_Status"
                                        data-align="center"
                                        data-width="150"
                                        data-events="CheckProcess_operateEvent"
                                        data-formatter="CheckProcessFormatter">
                                        Status
                                    </th>
                                    <th data-field="resetProcess"
                                        data-align="center"
                                        data-events="resetProcess_operateEvent"
                                        data-formatter="resetProcessFormatter">
                                        IF Failed
                                    </th>
                                    <th data-field="viewConnectivity"
                                        data-align="center"
                                        data-width="150"
                                        data-events="viewConnectivity_operateEvent"
                                        data-formatter="viewConnectivityFormatter">
                                        Connectivity
                                    </th>
                                    <th data-align="center" data-sortable="true"
                                        data-field="endTime">
                                        endTime
                                    </th>
                                    <th data-align="center" data-visible="false" data-sortable="true"
                                        data-field="dynamic_end_time">
                                        End Time
                                    </th>
                                    <th data-align="center" data-visible="false" data-sortable="true"
                                        data-formatter="serverFormatter"
                                        data-field="Server">
                                        Server
                                    </th>

                                    <th data-visible="false" data-field="UUID">
                                        UUID
                                    </th>
                                </tr>
                                </thead>
                                <tbody></tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    {% else %}
        <h1>{% translate 'Please Login in' %}</h1>
    {% endif %}



    <div id="WaitModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="mySmallModalLabel">
        <div class="modal-dialog modal-sm" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="progress">
                        <div class="progress-bar progress-bar-success progress-bar-striped" role="progressbar"
                             aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width: 100%">
                            Waiting for process
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}